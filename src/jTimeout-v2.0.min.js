/* 
	*
	*
	jTimeout v.2
	Made with love by Versatility Werks (http://flwebsites.biz)
	MIT Licensed
	*
	*
*/
!function(t){t.jTimeout=function(o){var e=this,n=!1,i=!1;e.options=t.extend({},t.jTimeout.defaults,o),e.generateUid=function(t){function o(){return(65536*(1+Math.random())|0).toString(16).substring(1)}var e=t||"-";return o()+o()+e+o()+e+o()+e+o()+e+o()+o()+o()},e.getTimer=function(){return window.localStorage.getItem("timeoutCountdown")},e.setTimer=function(t){return window.localStorage.setItem("timeoutCountdown",t)},e.getTab=function(){return window.localStorage.getItem("timeoutTab")},e.setTab=function(t){return window.localStorage.setItem("timeoutTab",t)},e.getTabLast=function(){return window.localStorage.getItem("timeoutTabLast")},e.setTabLast=function(){return window.localStorage.setItem("timeoutTabLast",new Date)},e.stopPriorCountdown=function(){e.priorCountDown&&(e.priorCountDown=!1)},e.stopFlashing=function(){e.options.flashTitle&&(e.flashingTitle&&window.clearInterval(e.flashingTitle),e.flashingTitle=!1,document.title=e.options.originalTitle)},e.startFlashing=function(){!e.flashingTitle&&e.options.flashTitle&&(e.flashingTitle=window.setInterval(function(){document.title=document.title==e.options.flashingTitleText?e.options.originalTitle:e.options.flashingTitleText},e.options.flashTitleSpeed))},e.startPriorCountdown=function(t){e.priorCountDown=t},e.hideAlerts=function(){var o=t("#jTimeoutAlert"),e=t("#jTimedoutAlert");o.length>0&&o.closeAlert(),e.length>0&&e.closeAlert()},e.countdown=function(){var o=e.getTimer(),s=e.getTab(),r=e.getTabLast();r<new Date("-2 seconds")&&(o-=Math.abs(((new Date).getTime()-r.getTime())/1e3),s=e.options.tabID,e.setTab(s)),e.priorCountDown&&e.priorCountDown.text(o),s==e.options.tabID&&(o-=e.options.heartbeat,e.setTabLast(),e.setTimer(o)),0>o&&!n?(i=!0,n=!0,e.options.onTimeout?e.options.onTimeout(e):(t.jAlert({id:"jTimedoutAlert",title:"Oh No!",content:"<b>Your session has timed out.</b>",theme:"red",btns:{text:"Login Again",href:e.options.loginUrl,theme:"blue",closeAlert:!1},closeOnClick:!1,closeBtn:!1,closeOnEsc:!1,replaceOtherAlerts:!0}),t.get(e.options.logoutUrl))):o<e.options.secondsPrior&&!i?(i=!0,e.startFlashing(),e.options.onPriorCallback?e.options.onPriorCallback(e):t.jAlert({id:"jTimeoutAlert",title:"Oh No!",content:'<b>Your session will timeout in <span class="jTimeout_Countdown">'+o+"</span> seconds!</b>",theme:"red",closeBtn:!1,onOpen:function(t){e.startPriorCountdown(t.find(".jTimeout_Countdown"))},btns:[{text:"Extend my Session",theme:"blue",onClick:function(o,n){return o.preventDefault(),e.options.onClickExtend?e.options.onClickExtend(e):(t.get(e.options.extendUrl),e.setTimer(e.options.timeoutAfter),e.setTab(e.options.tabID),e.setTabLast()),n.parents(".jAlert").closeAlert(),!1}},{text:"Logout Now",onClick:function(t){return t.preventDefault(),window.location.href=e.options.logoutUrl,!1}}]})):o>e.options.secondsPrior&&(i||n)&&(e.stopFlashing(),e.stopPriorCountdown(),e.hideAlerts(),i=!1,n=!1)},e.options.tabID||(e.options.tabID=e.generateUid()),e.setTimer(e.options.timeoutAfter),e.setTab(e.options.tabID),e.setTabLast();var s=1e3*e.options.heartbeat;return setInterval(e.countdown,s),e.options.extendOnMouseMove&&(s=1e3*e.options.mouseDebounce,e.mouseMoved=!1,t("body").on("mousemove",function(){e.mouseMoved||(e.mouseMoved=!0,window.setTimeout(function(){e.mouseMoved=!1},s),e.onMouseMove?e.options.onMouseMove():(t.get(e.options.extendUrl),e.setTimer(e.options.timeoutAfter),e.setTab(e.options.tabID),e.setTabLast()))})),this},t.jTimeout.reset=function(o){o="undefined"!=typeof o?o:t.jTimeout.defaults.timeoutAfter,window.localStorage.timeoutCountdown=o},t.jTimeout.defaults={flashTitle:!0,flashTitleSpeed:500,flashingTitleText:"**WARNING**",originalTitle:document.title,tabID:!1,timeoutAfter:1440,heartbeat:1,extendOnMouseMove:!0,mouseDebounce:30,onMouseMove:!1,extendUrl:"/dashboard",logoutUrl:"/logout",loginUrl:"/login",secondsPrior:60,onPriorCallback:!1,onClickExtend:!1,onTimeout:!1}}(jQuery);